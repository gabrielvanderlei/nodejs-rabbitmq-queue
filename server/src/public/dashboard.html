<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta http-equiv="X-UA-Compatible" content="IE=edge">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>RabbitMQ Chat</title>
</head>
<body>
    <script>

        var connection = new WebSocket('ws://'+window.location.host+':8080/requests');

        connection.onopen = function () {
            console.log('Connection open!');
        }

        connection.onclose = function () {
            console.log('Connection closed');
        }

        connection.onmessage = function (e) {
            var server_message = e.data;
            console.log(server_message);
            document.getElementById("requests").innerHTML += server_message + "<br>";
        }

        let sendMessage = () => {
            let message = document.getElementById('messageInput').value;
            let username = document.getElementById('usernameInput').value;

            let messageToSend = {
                action: "SEND_MESSAGE_TO_ALL",
                username,
                message
            };

            console.log(messageToSend)
            connection.send(JSON.stringify(messageToSend))
        }

    </script>
    <h1>Pedidos Pendentes</h1>
    <div id="requests"></div>
</body>
</html>